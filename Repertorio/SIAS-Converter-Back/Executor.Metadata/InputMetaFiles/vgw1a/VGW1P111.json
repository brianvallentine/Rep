{"Code": "EXEC SQL INSERT INTO SEGUROS.VG_N001_STA_GLOBAL (NUM_CERTIFICADO, SEQ_CRITICA, IND_TP_PROPOSTA, SIT_PROPOSTA, COD_MSG_CRITICA, NUM_CPF_CNPJ, NUM_PROPOSTA, NUM_APOLICE, COD_SUBGRUPO, COD_CRM, VLR_IS, VLR_PREMIO, DTA_OCORRENCIA, DTA_RCAP, STA_CRITICA, DES_COMPLEMENTAR_A, DES_COMPLEMENTAR_B, DES_COMPLEMENTAR_C, DES_COMPLEMENTAR_D, COD_USUARIO, NOM_PROGRAMA, DTH_CADASTRAMENTO, IND_TP_PROPOSTA_A, IND_TP_PROPOSTA_B, IND_TP_PROPOSTA_C, COD_MSG_CRITICA_A, COD_MSG_CRITICA_B, NUM_CPF_CNPJ_A, NUM_CPF_CNPJ_B, DTA_INI_OCORR, DTA_FIM_OCORR, STA_CRITICA_A, STA_CRITICA_B) SELECT VG103.NUM_CERTIFICADO, VG103.SEQ_CRITICA, VG103.IND_TP_PROPOSTA, BILHET.SITUACAO AS SIT_PROPOSTA, VG103.COD_MSG_CRITICA, VG103.NUM_CPF_CNPJ, IFNULL(VG103.NUM_PROPOSTA,0), 0 AS NUM_APOLICE, 0 AS COD_SUBGRUPO, 0 AS COD_CRM, VG103.VLR_IS, VG103.VLR_PREMIO, IFNULL(VG103.DTA_OCORRENCIA,'0001-01-01'), IFNULL(VG103.DTA_RCAP,'0001-01-01'), VG103.STA_CRITICA, CASE WHEN VG103.DES_COMPLEMENTAR IS NULL THEN ' ' WHEN LENGTH(RTRIM(VG103.DES_COMPLEMENTAR)) < 251 THEN RTRIM(VG103.DES_COMPLEMENTAR) ELSE SUBSTR(VG103.DES_COMPLEMENTAR,1,250) END AS DES_COMPLEMENTAR_A, CASE WHEN VG103.DES_COMPLEMENTAR IS NULL OR LENGTH(VG103.DES_COMPLEMENTAR) < 251 THEN ' ' WHEN LENGTH(VG103.DES_COMPLEMENTAR) < 501 THEN SUBSTR(VG103.DES_COMPLEMENTAR,251,LENGTH(VG103.DES_COMPLEMENTAR) - 250) ELSE SUBSTR(VG103.DES_COMPLEMENTAR,251,250) END AS DES_COMPLEMENTAR_B, CASE WHEN VG103.DES_COMPLEMENTAR IS NULL OR LENGTH(VG103.DES_COMPLEMENTAR) < 501 THEN ' ' WHEN LENGTH(VG103.DES_COMPLEMENTAR) < 751 THEN SUBSTR(VG103.DES_COMPLEMENTAR,501,LENGTH(VG103.DES_COMPLEMENTAR) - 500) ELSE SUBSTR(VG103.DES_COMPLEMENTAR,501,250) END AS DES_COMPLEMENTAR_C, CASE WHEN VG103.DES_COMPLEMENTAR IS NULL OR LENGTH(VG103.DES_COMPLEMENTAR) < 751 THEN ' ' WHEN LENGTH(VG103.DES_COMPLEMENTAR) < 1000 THEN SUBSTR(VG103.DES_COMPLEMENTAR,751,LENGTH(VG103.DES_COMPLEMENTAR) - 700) ELSE SUBSTR(VG103.DES_COMPLEMENTAR,751,250) END AS DES_COMPLEMENTAR_D, VG103.COD_USUARIO, VG103.NOM_PROGRAMA, VG103.DTH_CADASTRAMENTO, ' ' AS IND_TP_PROPOSTA_A, ' ' AS IND_TP_PROPOSTA_B, ' ' AS IND_TP_PROPOSTA_C, 0 AS COD_MSG_CRITICA_A, 0 AS COD_MSG_CRITICA_B, 0 AS NUM_CPF_CNPJ_A, 0 AS NUM_CPF_CNPJ_B, '0001-01-01' AS DTA_INI_OCORR, '9999-12-31' AS DTA_FIM_OCORR, ' ' AS STA_CRITICA_A, ' ' AS STA_CRITICA_B FROM SEGUROS.VG_CRITICA_PROPOSTA VG103 JOIN SEGUROS.BILHETE BILHET ON BILHET.NUM_BILHETE = VG103.NUM_CERTIFICADO WHERE VG103.NUM_CERTIFICADO = :W01_NUM_CERTIFICADO_A AND VG103.IND_TP_PROPOSTA = :IND_TP_PROPOSTA_A AND VG103.COD_MSG_CRITICA BETWEEN :COD_MSG_CRITICA_A AND :COD_MSG_CRITICA_B AND VG103.DTA_OCORRENCIA BETWEEN :DTA_INI_OCORR AND :DTA_FIM_OCORR UNION ALL SELECT VG103.NUM_CERTIFICADO, VG103.SEQ_CRITICA, VG103.IND_TP_PROPOSTA, PROPVA.SIT_REGISTRO AS SIT_PROPOSTA, VG103.COD_MSG_CRITICA, VG103.NUM_CPF_CNPJ, IFNULL(VG103.NUM_PROPOSTA,0), PROPVA.NUM_APOLICE, PROPVA.COD_SUBGRUPO, PROPVA.COD_CRM, VG103.VLR_IS, VG103.VLR_PREMIO, IFNULL(VG103.DTA_OCORRENCIA,'0001-01-01'), IFNULL(VG103.DTA_RCAP,'0001-01-01'), VG103.STA_CRITICA, CASE WHEN VG103.DES_COMPLEMENTAR IS NULL THEN ' ' WHEN LENGTH(RTRIM(VG103.DES_COMPLEMENTAR)) < 251 THEN RTRIM(VG103.DES_COMPLEMENTAR) ELSE SUBSTR(VG103.DES_COMPLEMENTAR,1,250) END AS DES_COMPLEMENTAR_A, CASE WHEN VG103.DES_COMPLEMENTAR IS NULL OR LENGTH(VG103.DES_COMPLEMENTAR) < 251 THEN ' ' WHEN LENGTH(VG103.DES_COMPLEMENTAR) < 501 THEN SUBSTR(VG103.DES_COMPLEMENTAR,251,LENGTH(VG103.DES_COMPLEMENTAR) - 250) ELSE SUBSTR(VG103.DES_COMPLEMENTAR,251,250) END AS DES_COMPLEMENTAR_B, CASE WHEN VG103.DES_COMPLEMENTAR IS NULL OR LENGTH(VG103.DES_COMPLEMENTAR) < 501 THEN ' ' WHEN LENGTH(VG103.DES_COMPLEMENTAR) < 751 THEN SUBSTR(VG103.DES_COMPLEMENTAR,501,LENGTH(VG103.DES_COMPLEMENTAR) - 500) ELSE SUBSTR(VG103.DES_COMPLEMENTAR,501,250) END AS DES_COMPLEMENTAR_C, CASE WHEN VG103.DES_COMPLEMENTAR IS NULL OR LENGTH(VG103.DES_COMPLEMENTAR) < 751 THEN ' ' WHEN LENGTH(VG103.DES_COMPLEMENTAR) < 1000 THEN SUBSTR(VG103.DES_COMPLEMENTAR,751,LENGTH(VG103.DES_COMPLEMENTAR) - 700) ELSE SUBSTR(VG103.DES_COMPLEMENTAR,751,250) END AS DES_COMPLEMENTAR_D, VG103.COD_USUARIO, VG103.NOM_PROGRAMA, VG103.DTH_CADASTRAMENTO, ' ' AS IND_TP_PROPOSTA_A, ' ' AS IND_TP_PROPOSTA_B, ' ' AS IND_TP_PROPOSTA_C, 0 AS COD_MSG_CRITICA_A, 0 AS COD_MSG_CRITICA_B, 0 AS NUM_CPF_CNPJ_A, 0 AS NUM_CPF_CNPJ_B, '0001-01-01' AS DTA_INI_OCORR, '9999-12-31' AS DTA_FIM_OCORR, ' ' AS STA_CRITICA_A, ' ' AS STA_CRITICA_B FROM SEGUROS.VG_CRITICA_PROPOSTA VG103 JOIN SEGUROS.PROPOSTAS_VA PROPVA ON PROPVA.NUM_CERTIFICADO = VG103.NUM_CERTIFICADO WHERE VG103.NUM_CERTIFICADO = :W01_NUM_CERTIFICADO_A AND VG103.IND_TP_PROPOSTA = :IND_TP_PROPOSTA_B AND VG103.COD_MSG_CRITICA BETWEEN :COD_MSG_CRITICA_A AND :COD_MSG_CRITICA_B AND VG103.DTA_OCORRENCIA BETWEEN :DTA_INI_OCORR AND :DTA_FIM_OCORR UNION ALL SELECT VG103.NUM_CERTIFICADO, VG103.SEQ_CRITICA, VG103.IND_TP_PROPOSTA, IFNULL(PROPVA.SIT_REGISTRO,' ') AS SIT_PROPOSTA, VG103.COD_MSG_CRITICA, VG103.NUM_CPF_CNPJ, IFNULL(VG103.NUM_PROPOSTA,0), IFNULL(PROPVA.NUM_APOLICE,0), IFNULL(PROPVA.COD_SUBGRUPO,0), IFNULL(PROPVA.COD_CRM,0), VG103.VLR_IS, VG103.VLR_PREMIO, IFNULL(VG103.DTA_OCORRENCIA,'0001-01-01'), IFNULL(VG103.DTA_RCAP,'0001-01-01'), VG103.STA_CRITICA, CASE WHEN VG103.DES_COMPLEMENTAR IS NULL THEN ' ' WHEN LENGTH(RTRIM(VG103.DES_COMPLEMENTAR)) < 251 THEN RTRIM(VG103.DES_COMPLEMENTAR) ELSE SUBSTR(VG103.DES_COMPLEMENTAR,1,250) END AS DES_COMPLEMENTAR_A, CASE WHEN VG103.DES_COMPLEMENTAR IS NULL OR LENGTH(VG103.DES_COMPLEMENTAR) < 251 THEN ' ' WHEN LENGTH(VG103.DES_COMPLEMENTAR) < 501 THEN SUBSTR(VG103.DES_COMPLEMENTAR,251,LENGTH(VG103.DES_COMPLEMENTAR) - 250) ELSE SUBSTR(VG103.DES_COMPLEMENTAR,251,250) END AS DES_COMPLEMENTAR_B, CASE WHEN VG103.DES_COMPLEMENTAR IS NULL OR LENGTH(VG103.DES_COMPLEMENTAR) < 501 THEN ' ' WHEN LENGTH(VG103.DES_COMPLEMENTAR) < 751 THEN SUBSTR(VG103.DES_COMPLEMENTAR,501,LENGTH(VG103.DES_COMPLEMENTAR) - 500) ELSE SUBSTR(VG103.DES_COMPLEMENTAR,501,250) END AS DES_COMPLEMENTAR_C, CASE WHEN VG103.DES_COMPLEMENTAR IS NULL OR LENGTH(VG103.DES_COMPLEMENTAR) < 751 THEN ' ' WHEN LENGTH(VG103.DES_COMPLEMENTAR) < 1000 THEN SUBSTR(VG103.DES_COMPLEMENTAR,751,LENGTH(VG103.DES_COMPLEMENTAR) - 700) ELSE SUBSTR(VG103.DES_COMPLEMENTAR,751,250) END AS DES_COMPLEMENTAR_D, VG103.COD_USUARIO, VG103.NOM_PROGRAMA, VG103.DTH_CADASTRAMENTO, ' ' AS IND_TP_PROPOSTA_A, ' ' AS IND_TP_PROPOSTA_B, ' ' AS IND_TP_PROPOSTA_C, 0 AS COD_MSG_CRITICA_A, 0 AS COD_MSG_CRITICA_B, 0 AS NUM_CPF_CNPJ_A, 0 AS NUM_CPF_CNPJ_B, '0001-01-01' AS DTA_INI_OCORR, '9999-12-31' AS DTA_FIM_OCORR, ' ' AS STA_CRITICA_A, ' ' AS STA_CRITICA_B FROM SEGUROS.VG_CRITICA_PROPOSTA VG103 JOIN SEGUROS.PROPOSTAS_VA PROPVA ON PROPVA.NUM_CERTIFICADO = VG103.NUM_CERTIFICADO JOIN SEGUROS.VG_SOLICITA_FATURA VGSOLF ON VGSOLF.NUM_APOLICE = PROPVA.NUM_APOLICE AND VGSOLF.COD_SUBGRUPO = PROPVA.COD_SUBGRUPO WHERE VG103.NUM_CERTIFICADO = :W01_NUM_CERTIFICADO_A AND VG103.IND_TP_PROPOSTA = :IND_TP_PROPOSTA_C AND VG103.COD_MSG_CRITICA BETWEEN :COD_MSG_CRITICA_A AND :COD_MSG_CRITICA_B AND VG103.DTA_OCORRENCIA BETWEEN :DTA_INI_OCORR AND :DTA_FIM_OCORR FETCH FIRST 400 ROWS ONLY END SQL", "Inputs": [{"Field": ":W01_NUM_CERTIFICADO_A", "Type": "string"}, {"Field": ":IND_TP_PROPOSTA_A", "Type": "string"}, {"Field": ":COD_MSG_CRITICA_A", "Type": "string"}, {"Field": ":COD_MSG_CRITICA_B", "Type": "string"}, {"Field": ":DTA_INI_OCORR", "Type": "string"}, {"Field": ":DTA_FIM_OCORR", "Type": "string"}], "Outputs": [], "Endpoint": "vgw1a/vgw1p111"}