{"DBCallId":"0a210bb2-594d-4907-9fe7-5a038bb0170b","TimeStamp":"2024-12-16T14:47:11.0821743-03:00","Query":" SELECT DATA_MOV_ABERTO FROM SEGUROS.SISTEMAS WHERE IDE_SISTEMA = 'VG'","sqlCode":0,"rowsCount":1,"Time":"0 ms","Error":""}
{"DBCallId":"d462609e-0903-427c-9c19-016f5bb9a95f","TimeStamp":"2024-12-16T14:47:44.4709599-03:00","Query":"SELECT A.NUM_CERTIFICADO , A.NUM_APOLICE , A.COD_SUBGRUPO , A.NUM_PARCELA , A.OCORR_HISTORICO , A.DTPROXVEN FROM SEGUROS.PROPOSTAS_VA A , SEGUROS.PRODUTOS_VG B WHERE B.ORIG_PRODU = 'ESPE1' AND A.NUM_APOLICE = B.NUM_APOLICE AND A.COD_SUBGRUPO = B.COD_SUBGRUPO AND A.SIT_REGISTRO IN ( '3' , '6' ) AND A.DTPROXVEN <> '9999-12-31' ORDER BY A.NUM_APOLICE , A.COD_SUBGRUPO","sqlCode":999,"rowsCount":0,"Time":"0 ms","Error":">>> Erro: ERROR [58005] [IBM][DB2.NET] SQL0902 An unexpected exception has occurred in Process: 13156 Thread 18 AppDomain: Name:testhost There are no context policies. Function: DB2DataReader.Read() CallStack: at System.Environment.get_StackTrace() at IBM.Data.Db2.DB2ConnPool.HandleUnknownErrors(String strFncMsg, Exception exception, Boolean bThrow) at IBM.Data.Db2.DB2DataReader.Read() at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1201 at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection) at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 737 at IA_ConverterCommons.QueryBasis`1.Open(Object procParams) in E:\\PROJETOS\\FOURSYS\\SIAS\\SIAS-Batch\\IA_ConverterCommons\\Basis\\QueryBasis.cs:line 234 at Sias.VidaEmGrupo.DB2.VG1625B.VG1625B_CPROPOVA.Open() in E:\\PROJETOS\\FOURSYS\\SIAS\\SIAS-Batch\\Sias.VidaEmGrupo\\DB2\\VG1625B\\VG1625B_CPROPOVA.cs:line 39 at Code.VG1625B.R0900_00_DECLA_PROPOVA_DB_OPEN_1() in E:\\PROJETOS\\FOURSYS\\SIAS\\SIAS-Batch\\Sias.VidaEmGrupo\\Code\\VG1625B.cs:line 1716 at FileTests.Test_DB.VG1625B_Tests_DB.VG1625B_Database() in E:\\PROJETOS\\FOURSYS\\SIAS\\SIAS-Batch\\FileTests.Test\\FileTests.Test\\VG1625B_Tests_DB.cs:line 25 at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor) at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr) at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters) at Xunit.Sdk.TestInvoker`1.CallTestMethod(Object testClassInstance) in /_/src/xunit.execution/Sdk/Frameworks/Runners/TestInvoker.cs:line 151 at Xunit.Sdk.TestInvoker`1.<>c__DisplayClass48_0.<<InvokeTestMethodAsync>b__1>d.MoveNext() in /_/src/xunit.execution/Sdk/Frameworks/Runners/TestInvoker.cs:line 278 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.TestInvoker`1.<>c__DisplayClass48_0.<InvokeTestMethodAsync>b__1() at Xunit.Sdk.ExecutionTimer.AggregateAsync(Func`1 asyncAction) in /_/src/xunit.execution/Sdk/Frameworks/ExecutionTimer.cs:line 48 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.ExecutionTimer.AggregateAsync(Func`1 asyncAction) at Xunit.Sdk.TestInvoker`1.<>c__DisplayClass48_0.<InvokeTestMethodAsync>b__0() in /_/src/xunit.execution/Sdk/Frameworks/Runners/TestInvoker.cs:line 243 at Xunit.Sdk.ExceptionAggregator.RunAsync(Func`1 code) in /_/src/xunit.core/Sdk/ExceptionAggregator.cs:line 90 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.ExceptionAggregator.RunAsync(Func`1 code) at Xunit.Sdk.TestInvoker`1.InvokeTestMethodAsync(Object testClassInstance) in /_/src/xunit.execution/Sdk/Frameworks/Runners/TestInvoker.cs:line 242 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.TestInvoker`1.InvokeTestMethodAsync(Object testClassInstance) at Xunit.Sdk.XunitTestInvoker.InvokeTestMethodAsync(Object testClassInstance) in /_/src/xunit.execution/Sdk/Frameworks/Runners/XunitTestInvoker.cs:line 112 at Xunit.Sdk.TestInvoker`1.<RunAsync>b__47_0() in /_/src/xunit.execution/Sdk/Frameworks/Runners/TestInvoker.cs:line 207 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.TestInvoker`1.<RunAsync>b__47_0() at Xunit.Sdk.ExceptionAggregator.RunAsync[T](Func`1 code) in /_/src/xunit.core/Sdk/ExceptionAggregator.cs:line 107 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.ExceptionAggregator.RunAsync[T](Func`1 code) at Xunit.Sdk.TestInvoker`1.RunAsync() in /_/src/xunit.execution/Sdk/Frameworks/Runners/TestInvoker.cs:line 190 at Xunit.Sdk.XunitTestRunner.InvokeTestMethodAsync(ExceptionAggregator aggregator) in /_/src/xunit.execution/Sdk/Frameworks/Runners/XunitTestRunner.cs:line 84 at Xunit.Sdk.XunitTestRunner.InvokeTestAsync(ExceptionAggregator aggregator) in /_/src/xunit.execution/Sdk/Frameworks/Runners/XunitTestRunner.cs:line 67 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.XunitTestRunner.InvokeTestAsync(ExceptionAggregator aggregator) at Xunit.Sdk.TestRunner`1.<>c__DisplayClass43_0.<RunAsync>b__0() in /_/src/xunit.execution/Sdk/Frameworks/Runners/TestRunner.cs:line 149 at Xunit.Sdk.ExceptionAggregator.RunAsync[T](Func`1 code) in /_/src/xunit.core/Sdk/ExceptionAggregator.cs:line 107 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.ExceptionAggregator.RunAsync[T](Func`1 code) at Xunit.Sdk.TestRunner`1.RunAsync() in /_/src/xunit.execution/Sdk/Frameworks/Runners/TestRunner.cs:line 149 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.TestRunner`1.RunAsync() at Xunit.Sdk.XunitTestCaseRunner.RunTestAsync() in /_/src/xunit.execution/Sdk/Frameworks/Runners/XunitTestCaseRunner.cs:line 139 at Xunit.Sdk.TestCaseRunner`1.RunAsync() in /_/src/xunit.execution/Sdk/Frameworks/Runners/TestCaseRunner.cs:line 82 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.TestCaseRunner`1.RunAsync() at Xunit.Sdk.XunitTestCase.RunAsync(IMessageSink diagnosticMessageSink, IMessageBus messageBus, Object[] constructorArguments, ExceptionAggregator aggregator, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Sdk/Frameworks/XunitTestCase.cs:line 162 at Xunit.Sdk.XunitTestMethodRunner.RunTestCaseAsync(IXunitTestCase testCase) in /_/src/xunit.execution/Sdk/Frameworks/Runners/XunitTestMethodRunner.cs:line 45 at Xunit.Sdk.TestMethodRunner`1.RunTestCasesAsync() in /_/src/xunit.execution/Sdk/Frameworks/Runners/TestMethodRunner.cs:line 136 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.TestMethodRunner`1.RunTestCasesAsync() at Xunit.Sdk.TestMethodRunner`1.RunAsync() in /_/src/xunit.execution/Sdk/Frameworks/Runners/TestMethodRunner.cs:line 106 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.TestMethodRunner`1.RunAsync() at Xunit.Sdk.XunitTestClassRunner.RunTestMethodAsync(ITestMethod testMethod, IReflectionMethodInfo method, IEnumerable`1 testCases, Object[] constructorArguments) in /_/src/xunit.execution/Sdk/Frameworks/Runners/XunitTestClassRunner.cs:line 199 at Xunit.Sdk.TestClassRunner`1.RunTestMethodsAsync() at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.TestClassRunner`1.RunTestMethodsAsync() at Xunit.Sdk.TestClassRunner`1.RunAsync() in /_/src/xunit.execution/Sdk/Frameworks/Runners/TestClassRunner.cs:line 175 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.TestClassRunner`1.RunAsync() at Xunit.Sdk.XunitTestCollectionRunner.RunTestClassAsync(ITestClass testClass, IReflectionTypeInfo class, IEnumerable`1 testCases) in /_/src/xunit.execution/Sdk/Frameworks/Runners/XunitTestCollectionRunner.cs:line 185 at Xunit.Sdk.TestCollectionRunner`1.RunTestClassesAsync() at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.TestCollectionRunner`1.RunTestClassesAsync() at Xunit.Sdk.TestCollectionRunner`1.RunAsync() in /_/src/xunit.execution/Sdk/Frameworks/Runners/TestCollectionRunner.cs:line 101 at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine) at Xunit.Sdk.TestCollectionRunner`1.RunAsync() at Xunit.Sdk.XunitTestAssemblyRunner.RunTestCollectionAsync(IMessageBus messageBus, ITestCollection testCollection, IEnumerable`1 testCases, CancellationTokenSource cancellationTokenSource) in /_/src/xunit.execution/Sdk/Frameworks/Runners/XunitTestAssemblyRunner.cs:line 262 at Xunit.Sdk.XunitTestAssemblyRunner.<>c__DisplayClass14_2.<RunTestCollectionsAsync>b__2() in /_/src/xunit.execution/Sdk/Frameworks/Runners/XunitTestAssemblyRunner.cs:line 211 at System.Threading.Tasks.Task`1.InnerInvoke() at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread) at System.Threading.Tasks.Task.ExecuteEntry() at System.Threading.Tasks.SynchronizationContextTaskScheduler.<>c.<.cctor>b__8_0(Object s) at Xunit.Sdk.MaxConcurrencySyncContext.RunOnSyncContext(SendOrPostCallback callback, Object state) in /_/src/xunit.execution/Sdk/MaxConcurrencySyncContext.cs:line 106 at Xunit.Sdk.MaxConcurrencySyncContext.<>c__DisplayClass11_0.<WorkerThreadProc>b__0(Object _) in /_/src/xunit.execution/Sdk/MaxConcurrencySyncContext.cs:line 96 at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state) at Xunit.Sdk.ExecutionContextHelper.Run(Object context, Action`1 action) in /_/src/xunit.execution/Sdk/Utility/ExecutionContextHelper.cs:line 110 at Xunit.Sdk.MaxConcurrencySyncContext.WorkerThreadProc() in /_/src/xunit.execution/Sdk/MaxConcurrencySyncContext.cs:line 96 at Xunit.Sdk.XunitWorkerThread.<>c.<QueueUserWorkItem>b__5_0(Object _) in /_/src/common/XunitWorkerThread.cs:line 37 at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread) InnerException Message: Invalid Handle Check InnerException property for more detail. SQLSTATE=58005"}
{"DBCallId":"84f06cf5-b8bd-4011-b856-7565537d1395","TimeStamp":"2024-12-16T14:47:47.2280721-03:00","Query":" SELECT COUNT(*) FROM SEGUROS.SEGURADOS_VGAP WHERE NUM_APOLICE = '0000000000000' AND COD_SUBGRUPO = '0000' AND SIT_REGISTRO IN ( '0' , '1' ) AND COD_PROFISSAO = 9999","sqlCode":0,"rowsCount":1,"Time":"0 ms","Error":""}
{"DBCallId":"a4f9264d-f525-4aae-81ef-285b5624a5bd","TimeStamp":"2024-12-16T14:47:47.996331-03:00","Query":" SELECT PERI_FATURAMENTO FROM SEGUROS.SUBGRUPOS_VGAP WHERE NUM_APOLICE = '0000000000000' AND COD_SUBGRUPO = '0000'","sqlCode":0,"rowsCount":1,"Time":"0 ms","Error":""}
{"DBCallId":"07ada44b-0b09-4337-9d58-35e7aeb1af34","TimeStamp":"2024-12-16T14:47:48.704003-03:00","Query":" SELECT DATA_VENCIMENTO , PREMIO_VG , SIT_REGISTRO FROM SEGUROS.PARCELAS_VIDAZUL WHERE NUM_CERTIFICADO = '0000000000000' AND NUM_PARCELA = '0000' AND DATA_VENCIMENTO > '2023-07-19'","sqlCode":0,"rowsCount":0,"Time":"0 ms","Error":""}
{"DBCallId":"81ce77f4-5268-479d-8573-2548dd440482","TimeStamp":"2024-12-16T14:47:49.5825269-03:00","Query":" SELECT NUM_CERTIFICADO , OCORR_HISTORICO , DATA_INIVIGENCIA , DATA_INIVIGENCIA + 0000 MONTHS , DATA_TERVIGENCIA , IMPSEGUR , QUANT_VIDAS , IMPSEGIND , COD_OPERACAO , OPCAO_COBERTURA , IMP_MORNATU , IMPMORACID , IMPINVPERM , IMPAMDS , IMPDH , IMPDIT , VLPREMIO , PRMVG , PRMAP , QTDE_TIT_CAPITALIZ , VAL_TIT_CAPITALIZ , VAL_CUSTO_CAPITALI , IMPSEGCDG , VLCUSTCDG , COD_USUARIO FROM SEGUROS.HIS_COBER_PROPOST WHERE NUM_CERTIFICADO = '000000000000000' AND OCORR_HISTORICO = '0000'","sqlCode":0,"rowsCount":1,"Time":"0 ms","Error":""}
{"DBCallId":"42ba68f8-1158-43e7-96d7-747bbeffd4f1","TimeStamp":"2024-12-16T14:47:51.6088902-03:00","Query":" SELECT A.PRM_VG + A.PRM_AP , B.IMP_MORNATU FROM SEGUROS.PLANOS_FAIXAETA A , SEGUROS.PLANOS_VGAP B , SEGUROS.SUBGRUPOS_VGAP C WHERE A.NUM_APOLICE = '0000000000000' AND B.SIT_REGISTRO = '0' AND C.COD_SUBGRUPO = '0000' AND B.NUM_APOLICE = A.NUM_APOLICE AND B.COD_SUBGRUPO = A.COD_SUBGRUPO AND B.COD_PLANO = A.COD_PLANO AND C.NUM_APOLICE = A.NUM_APOLICE AND C.COD_SUBGRUPO = A.COD_SUBGRUPO","sqlCode":0,"rowsCount":0,"Time":"0 ms","Error":""}
{"DBCallId":"93185daa-65ac-4601-b725-2b086649085c","TimeStamp":"2024-12-16T14:47:52.9104924-03:00","Query":" SELECT VALUE (MAX (COD_PLANO) ,0) FROM SEGUROS.PLANOS_VGAP WHERE NUM_APOLICE = '0000000000000' AND COD_SUBGRUPO = '0000'","sqlCode":0,"rowsCount":1,"Time":"0 ms","Error":""}
{"DBCallId":"69ee8cbd-d7e7-4fd8-a644-7a0b3c9b7704","TimeStamp":"2024-12-16T14:47:53.9446578-03:00","Query":" SELECT VALUE (MIN (COD_PLANO) ,0) FROM SEGUROS.PLANOS_VGAP WHERE NUM_APOLICE = '0000000000000' AND SIT_REGISTRO = '0' AND COD_SUBGRUPO = '0000'","sqlCode":0,"rowsCount":1,"Time":"0 ms","Error":""}
{"DBCallId":"d2112a35-9113-455b-9d01-fb870ca0bb9f","TimeStamp":"2024-12-16T14:47:54.6710877-03:00","Query":" UPDATE SEGUROS.PLANOS_VGAP SET SIT_REGISTRO = ' ' WHERE NUM_APOLICE = '0000000000000' AND COD_PLANO = '0000' AND COD_SUBGRUPO = '0000'","sqlCode":0,"rowsCount":0,"Time":"0 ms","Error":""}
{"DBCallId":"ddcecbcb-1d34-4aba-8603-23dff8800618","TimeStamp":"2024-12-16T14:47:55.3501294-03:00","Query":" INSERT INTO SEGUROS.HIS_COBER_PROPOST (NUM_CERTIFICADO , OCORR_HISTORICO , DATA_INIVIGENCIA , DATA_TERVIGENCIA , IMPSEGUR , QUANT_VIDAS , IMPSEGIND , COD_OPERACAO , OPCAO_COBERTURA , IMP_MORNATU , IMPMORACID , IMPINVPERM , IMPAMDS , IMPDH , IMPDIT , VLPREMIO , PRMVG , PRMAP , QTDE_TIT_CAPITALIZ, VAL_TIT_CAPITALIZ , VAL_CUSTO_CAPITALI, IMPSEGCDG , VLCUSTCDG , COD_USUARIO , TIMESTAMP , IMPSEGAUXF , VLCUSTAUXF , PRMDIT , QTMDIT ) VALUES ('000000000000000', '0000', '2021-01-01', '2022-01-01', '0000000000000.00', '000000000', '0000000000000.00', '0000', ' ' , '0000000000000.00', '0000000000000.00', '0000000000000.00', '0000000000000.00', '0000000000000.00', '0000000000000.00', '0000000000000.00', '0000000000000.00', '0000000000000.00', '0000', '0000000000000.00', '0000000000000.00', '0000000000000.00', '0000000000000.00', 'VG1625B' , CURRENT TIMESTAMP, NULL, NULL, NULL, NULL)","sqlCode":999,"rowsCount":0,"Time":"0 ms","Error":">>> Erro: ERROR [23505] [IBM][DB2] SQL0803N One or more values in the INSERT statement, UPDATE statement, or foreign key update caused by a DELETE statement are not valid because the primary key, unique constraint or unique index identified by \"I2GVT002\" constrains table \"0000008232\" from having duplicate values for the index key. SQLSTATE=23505"}
{"DBCallId":"a523735c-12e4-44dd-8e89-eb9e0c407144","TimeStamp":"2024-12-16T14:47:56.315946-03:00","Query":" UPDATE SEGUROS.HIS_COBER_PROPOST SET DATA_TERVIGENCIA = DATA_INIVIGENCIA + 0000 MONTHS - 1 DAY WHERE NUM_CERTIFICADO = '000000000000000' AND OCORR_HISTORICO = '0000'","sqlCode":0,"rowsCount":1,"Time":"0 ms","Error":""}
{"DBCallId":"ebbfb4e6-8815-47f8-8efd-d2358841dddc","TimeStamp":"2024-12-16T14:47:57.0642622-03:00","Query":" UPDATE SEGUROS.PROPOSTAS_VA SET OCORR_HISTORICO = '0000', NUM_PARCELA = '0000' + 1 WHERE NUM_CERTIFICADO = '000000000000000'","sqlCode":0,"rowsCount":0,"Time":"0 ms","Error":""}
{"DBCallId":"f473f5c5-8cdf-4178-9289-6b86a830f7e1","TimeStamp":"2024-12-16T14:47:57.7739472-03:00","Query":" UPDATE SEGUROS.HIS_COBER_PROPOST SET IMPSEGUR = '0000000000000.00', IMPSEGIND = '0000000000000.00', IMP_MORNATU = '0000000000000.00', QUANT_VIDAS = '000000000', VLPREMIO = '0000000000000.00', PRMVG = '0000000000000.00' WHERE NUM_CERTIFICADO = '000000000000000' AND OCORR_HISTORICO = '0000'","sqlCode":0,"rowsCount":1,"Time":"0 ms","Error":""}
{"DBCallId":"b1f2170f-234b-4f9a-9521-ff89d0c75e4c","TimeStamp":"2024-12-16T14:47:59.4753741-03:00","Query":" UPDATE SEGUROS.PARCELAS_VIDAZUL SET PREMIO_VG = '0000000000000.00' WHERE NUM_CERTIFICADO = '000000000000000' AND NUM_PARCELA = '0000'","sqlCode":0,"rowsCount":1,"Time":"0 ms","Error":""}
{"DBCallId":"72e207e2-cfaa-49a2-bfd3-aaf53c7dcf61","TimeStamp":"2024-12-16T14:48:00.1450332-03:00","Query":" UPDATE SEGUROS.COBER_HIST_VIDAZUL SET PRM_TOTAL = '0000000000000.00', SIT_REGISTRO = '5' WHERE NUM_CERTIFICADO = '000000000000000' AND NUM_PARCELA = '0000'","sqlCode":0,"rowsCount":1,"Time":"8 ms","Error":""}